webpackJsonp([43],{IbUw:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("mvHQ"),o=e.n(a),i=e("Au9i"),n={data:function(){return{defaultAddress:null,goodsList:[],addressId:"",content:"",totalPrice:0,payInfo:{},all:0}},methods:{payType:function(t){var s=this;if("0"===t)this.post("home/Pay/payForMoney",{id:this.payInfo.id,type:this.payInfo.type}).then(function(t){t.data.code,s.$router.push("/info"),Object(i.Toast)({message:t.data.info,duration:1e3})});else{var e=localStorage.getItem("token");location.href="http://flm.yunkzx.com/home/Shop/order_pay?token="+e+"&id="+this.payInfo.id+"&type="+this.payInfo.type}},getOrderList:function(t){var s=this;this.post("home/Shop/showAllShop",{idList:t}).then(function(t){1e4===t.data.code&&(s.defaultAddress=t.data.info.address,null!==s.defaultAddress&&(s.addressId=t.data.info.address.address_id,s.defaultAddress.city=JSON.parse(t.data.info.address.city)),s.goodsList=t.data.info.data,s.goodsList.forEach(function(t){t.pic_url=s.imageURL(t.pic_url),s.totalPrice+=t.good_price*t.good_num,s.all+=t.yunfei-0}))})},submitOrder:function(){var t=this;this.$refs.pop.value="";var s=[];this.goodsList.forEach(function(t){var e={};e.good_id=t.id,e.number=t.good_num,s.push(e)}),""!==this.addressId?(i.Indicator.open(),this.post("home/Order/createOrder",{list:o()(s),address_id:this.addressId,content:this.content,type:1}).then(function(s){1e4===s.data.code&&(t.$refs.pop.popupVisible=!0,t.payInfo=s.data.info),i.Indicator.close()})):Object(i.Toast)({message:"请添加收货地址",duration:1e3})},back:function(){this.$router.go(-1)},selectAddress:function(){this.$router.push("/site")}},components:{pop:e("UQv7").a},mounted:function(){var t=this.$route.params.id;this.getOrderList(t)}},r={render:function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"setOrder"},[a("header",{staticClass:"count_top header"},[a("img",{attrs:{src:e("0+aQ"),alt:""},on:{click:t.back}}),t._v(" "),a("span",[t._v("确认订单")])]),t._v(" "),a("div",{on:{click:t.selectAddress}},[null===t.defaultAddress?a("section",{staticClass:"order_w"},[a("img",{attrs:{src:e("Nn4G"),alt:"",width:"50"}}),t._v(" "),a("span",[t._v("请添加收货地址")])]):a("section",{staticClass:"order_address_t"},[t._m(0),t._v(" "),a("div",[a("section",{staticClass:"address_title"},[a("p",[t._v("收件人: "+t._s(t.defaultAddress.username))]),t._v(" "),a("p",[t._v(t._s(t.defaultAddress.telphone))])]),t._v(" "),a("p",[t._v("\n            收货地址: "),t._l(t.defaultAddress.city,function(s){return a("span",[t._v(t._s(s.name))])}),t._v(t._s(t.defaultAddress.address)+"\n          ")],2)]),t._v(" "),t._m(1)])]),t._v(" "),a("ul",t._l(t.goodsList,function(s,e){return a("li",{staticClass:"order_good",on:{click:t.back}},[a("section",[a("img",{attrs:{src:s.pic_url,alt:""}})]),t._v(" "),a("section",[a("p",{staticClass:"good_name"},[t._v(t._s(s.good_name))]),t._v(" "),a("div",{staticClass:"good_num"},[a("p",{staticClass:"good_price"},[t._v("¥ "+t._s(s.good_price))]),t._v(" "),a("p",[t._v("x "+t._s(s.good_num))])])])])})),t._v(" "),a("label",{staticClass:"site"},[a("span",[t._v("买家留言:")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],attrs:{type:"text",placeholder:"选填,可填写和卖家达成一致的要求"},domProps:{value:t.content},on:{input:function(s){s.target.composing||(t.content=s.target.value)}}})]),t._v(" "),a("section",{staticClass:"goods_price"},[a("span",[t._v("运费")]),t._v(" "),a("span",[t._v("¥"+t._s(t.all))])]),t._v(" "),a("section",{staticClass:"goods_price"},[a("span",[t._v("订单总价")]),t._v(" "),a("span",[t._v("¥"+t._s(t.totalPrice))])]),t._v(" "),a("section",{staticClass:"goods_price"},[a("span",[t._v("需付款")]),t._v(" "),a("span",{staticClass:"price_d"},[t._v("¥"+t._s(t.totalPrice))])]),t._v(" "),a("footer",{staticClass:"order_btn"},[a("section",{staticClass:"btn_l"},[a("span",[t._v("合计:")]),t._v(" "),a("span",[t._v("¥"+t._s(t.totalPrice+t.all))])]),t._v(" "),a("section",{staticClass:"btn_r",on:{click:t.submitOrder}},[t._v("\n      提交订单\n    ")])]),t._v(" "),a("pop",{ref:"pop",on:{show:t.payType}})],1)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",[s("img",{attrs:{src:e("Nn4G"),alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",[s("img",{attrs:{src:e("Z++a"),alt:""}})])}]};var d=e("VU/8")(n,r,!1,function(t){e("kVri")},"data-v-57fc886f",null);s.default=d.exports},kVri:function(t,s){}});
//# sourceMappingURL=43.71214fbbdbd7efc72ef9.js.map